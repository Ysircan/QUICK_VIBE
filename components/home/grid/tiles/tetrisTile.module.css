/* components/home/grid/tiles/tetrisTile.module.css */
/* ✅ 强制整张卡片文字为黑色（不依赖外部继承），避免被全局主题把字体变白 */

.uiPanel{
  border:2px solid var(--ink, #111);
  background: rgba(255,255,255,.84);
  border-radius: 18px;
  box-shadow: 10px 10px 0 var(--ink, #111);
  color: var(--ink, #111);
}

.tileWrap{
  padding: 10px 14px 16px 10px; /* right/bottom bigger */
}

.tile{
  box-sizing: border-box;
  height: 560px;
  display:flex;
  flex-direction:column;
  overflow:hidden;
  box-shadow: 8px 8px 0 var(--ink, #111);

  /* ✅ 关键：全局有可能把 text 设成白色，这里强制回黑色 */
  color: var(--ink, #111);
}

.tile *, .tile *::before, .tile *::after{
  box-sizing: inherit;
}

/* ===== header ===== */
.tileHeader{
  padding: 12px 12px 10px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 10px;
  color: var(--ink, #111);
}

.left{
  display:flex;
  align-items:center;
  gap: 10px;
  flex-wrap: wrap;
}

.meta{
  font-size: 12px;
  font-weight: 900;
  letter-spacing:.2px;
  line-height: 1.1;

  /* ✅ 不用 opacity（可能叠加导致发白），直接用 rgba */
  color: rgba(17,17,17,.72);
}

/* ===== pills ===== */
.uiPill{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: 6px 12px;
  border-radius: 999px;
  border:2px solid var(--ink, #111);
  background: rgba(255,255,255,.92);
  box-shadow: 0 2px 0 var(--ink, #111);
  font-weight: 950;
  letter-spacing:.2px;
  line-height: 1;
  user-select:none;
  white-space:nowrap;
  color: var(--ink, #111);
}

.uiDot{
  width:10px;
  height:10px;
  border-radius:999px;
  background: var(--yellow, #ffe279);
  border:2px solid var(--ink, #111);
  box-shadow: 0 2px 0 var(--ink, #111);
  flex:0 0 auto;
}

.capBtn{
  display:inline-flex;
  align-items:center;
  gap:8px;
  height: 36px;
  padding: 0 14px;
  border-radius: 999px;
  border:2px solid var(--ink, #111);
  background: rgba(255,255,255,.92);
  box-shadow: 0 3px 0 var(--ink, #111);
  font-weight: 1000;
  user-select:none;
  white-space:nowrap;
  color: var(--ink, #111);
}

/* ===== layout ===== */
.body{
  flex:1;
  padding: 0 12px 12px;
  display:flex;
  flex-direction:column;
  gap: 12px;
  min-height: 0;
  color: var(--ink, #111);
}

.panel{
  border:2px solid var(--ink, #111);
  border-radius: 14px;
  box-shadow: 0 6px 0 var(--ink, #111);
  overflow:hidden;
  background: rgba(255,255,255,.78);
  color: var(--ink, #111);
}

.panelTop{
  padding: 8px 10px;
  border-bottom:2px solid var(--ink, #111);
  background: rgba(255,255,255,.92);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  font-weight: 1000;
  letter-spacing:.25px;
  font-size: 12px;
  color: var(--ink, #111);
}

/* ===== code ===== */
.codePanel{
  height: 138px;
  display:flex;
  flex-direction:column;
  min-height:0;
}

.codeArea{
  flex:1;
  padding: 10px 12px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  font-size: 12px;
  line-height: 1.35;
  white-space: pre-wrap;
  overflow:auto;

  /* ✅ 强制代码颜色 */
  color: var(--ink, #111);
}

.codeLine{
  opacity:0;
  transform: translateY(6px);
  animation: lineIn .22s ease-out forwards;
  color: var(--ink, #111);
}

@keyframes lineIn{
  to{ opacity:1; transform: translateY(0); }
}

/* ===== result ===== */
.resultPanel{
  flex:1;
  min-height:0;
  display:flex;
  flex-direction:column;
}

.resultCanvas{
  flex:1;
  min-height:0;
  padding: 10px;
  position:relative;
  overflow:hidden;
  background: rgba(255,255,255,.62);
  color: var(--ink, #111);
}

/* ===== bottom vibe prompt ===== */
.promptRow{
  margin-top: auto;
  border:2px solid var(--ink, #111);
  border-radius: 999px;
  background: rgba(255,255,255,.92);
  box-shadow: 0 4px 0 var(--ink, #111);
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 8px 10px;
  color: var(--ink, #111);
}

.promptLabel{
  font-weight: 1000;
  font-size: 12px;
  letter-spacing:.25px;
  white-space:nowrap;
  padding-left: 2px;
  color: rgba(17,17,17,.82);
}

.promptText{
  flex:1;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","CourierNew", monospace;
  font-size: 12px;
  white-space: nowrap;
  overflow:hidden;
  text-overflow: ellipsis;
  color: rgba(17,17,17,.86);
}

.sendBtn{
  height: 34px;
  padding: 0 12px;
  border-radius: 999px;
  border:2px solid var(--ink, #111);
  background: var(--yellow, #ffe279);
  box-shadow: 0 3px 0 var(--ink, #111);
  font-weight: 1000;
  cursor:pointer;
  user-select:none;
  display:inline-flex;
  align-items:center;
  gap: 8px;
  color: var(--ink, #111);
}

.sendBtn:disabled{
  opacity:.65;
  cursor: default;
}

/* ===== tetris ===== */
.tetrisWrap{
  height:100%;
  display:grid;
  grid-template-columns: 152px 1fr;
  gap: 10px;
  align-items:start;
}

.tBoard{
  width: 152px;
  height: 210px;
  border:2px solid var(--ink, #111);
  border-radius: 12px;
  background:
    linear-gradient(rgba(0,0,0,.07) 1px, transparent 1px) 0 0 / 14px 14px,
    linear-gradient(90deg, rgba(0,0,0,.07) 1px, transparent 1px) 0 0 / 14px 14px,
    rgba(255,255,255,.78);
  box-shadow: 0 4px 0 var(--ink, #111);
  position:relative;
  overflow:hidden;
}

.tPiece{
  position:absolute;
  left: 52px;
  top: -28px;
  width: 44px;
  height: 14px;
  border-radius: 8px;
  border:2px solid var(--ink, #111);
  background: var(--yellow, #ffe279);
  box-shadow: 0 3px 0 var(--ink, #111);
  opacity:0;
}

.tPiece::after{
  content:"";
  position:absolute;
  left: 14px;
  top: 14px;
  width: 14px;
  height: 14px;
  border-radius: 6px;
  border:2px solid var(--ink, #111);
  background: var(--yellow, #ffe279);
  box-shadow: 0 3px 0 var(--ink, #111);
}

.kpiStack{
  height:100%;
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.kpiBox{
  border:2px solid var(--ink, #111);
  border-radius: 14px;
  background: rgba(255,255,255,.82);
  box-shadow: 0 6px 0 var(--ink, #111);
  padding: 10px;
  color: var(--ink, #111);
}

.k{
  font-size: 11px;
  font-weight: 1000;
  letter-spacing:.25px;
  color: rgba(17,17,17,.72);
}

.v{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  font-size: 18px;
  font-weight: 1000;
  margin-top: 4px;
  color: var(--ink, #111);
}

.bar{
  margin-top: 8px;
  height: 12px;
  border:2px solid var(--ink, #111);
  border-radius: 999px;
  overflow:hidden;
  background: rgba(255,255,255,.78);
}

.bar > i{
  display:block;
  height:100%;
  width: 22%;
  background: rgba(255,226,121,.92);
  border-right:2px solid var(--ink, #111);
}

/* motion only */
.tile[data-state="running"] .tPiece{
  opacity:1;
  animation: drop 1.25s linear infinite;
}

@keyframes drop{
  0%{ transform: translateY(0); opacity:1; }
  70%{ transform: translateY(182px); opacity:1; }
  100%{ transform: translateY(238px); opacity:0; }
}

.tile[data-state="running"] .bar > i{
  animation: fill 2.0s ease-in-out infinite;
}

@keyframes fill{
  0%{ width: 22%; }
  60%{ width: 80%; }
  100%{ width: 22%; }
}
